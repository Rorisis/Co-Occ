/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/torch/distributed/launch.py:186: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  FutureWarning,
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2023-10-25 09:10:46,294 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.0 (default, Oct  9 2018, 10:31:47) [GCC 7.3.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA A40
CUDA_HOME: /hpc2ssd/softwares/cuda/cuda-11.3
NVCC: Build cuda_11.3.r11.3/compiler.29920130_0
GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
PyTorch: 1.10.1
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX512
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.11.2
OpenCV: 4.8.0
MMCV: 1.4.0
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.3
MMDetection: 2.14.0
MMSegmentation: 0.14.1
MMDetection3D: 0.17.1+5e630a3
------------------------------------------------------------

2023-10-25 09:10:47,460 - mmdet - INFO - Distributed training: True
2023-10-25 09:10:48,609 - mmdet - INFO - Config:
point_cloud_range = [-50, -50, -5.0, 50, 50, 3.0]
class_names = [
    'empty', 'barrier', 'bicycle', 'bus', 'car', 'construction_vehicle',
    'motorcycle', 'pedestrian', 'traffic_cone', 'trailer', 'truck',
    'driveable_surface', 'other_flat', 'sidewalk', 'terrain', 'manmade',
    'vegetation'
]
dataset_type = 'CustomNuScenesOccLSSDataset'
data_root = 'data/nuscenes'
input_modality = dict(
    use_lidar=True,
    use_camera=True,
    use_radar=False,
    use_map=False,
    use_external=False)
file_client_args = dict(backend='disk')
train_pipeline = [
    dict(type='LoadPointsFromFile', coord_type='LIDAR', load_dim=5, use_dim=5),
    dict(type='LoadPointsFromMultiSweeps', sweeps_num=10),
    dict(
        type='LoadMultiViewImageFromFiles_OccFormer',
        is_train=True,
        data_config=dict(
            cams=[
                'CAM_FRONT_LEFT', 'CAM_FRONT', 'CAM_FRONT_RIGHT',
                'CAM_BACK_LEFT', 'CAM_BACK', 'CAM_BACK_RIGHT'
            ],
            Ncams=6,
            input_size=(896, 1600),
            src_size=(900, 1600),
            resize=(0, 0),
            rot=(0, 0),
            flip=False,
            crop_h=(0.0, 0.0),
            resize_test=0.0),
        img_norm_cfg=dict(
            mean=[123.675, 116.28, 103.53],
            std=[58.395, 57.12, 57.375],
            to_rgb=True)),
    dict(type='CreateDepthFromLiDAR', dataset='nusc'),
    dict(
        type='LoadOccupancy',
        is_train=True,
        to_float32=True,
        use_semantic=True,
        occ_path='./data/nuscenes_occ',
        grid_size=[200, 200, 16],
        use_vel=False,
        unoccupied=0,
        pc_range=[-50, -50, -5.0, 50, 50, 3.0],
        cal_visible=False,
        bda_aug_conf=dict(
            rot_lim=(0, 0),
            scale_lim=(1, 1),
            flip_dx_ratio=0,
            flip_dy_ratio=0,
            flip_dz_ratio=0),
        cls_metas='projects/configs/_base_/nuscenes.yaml'),
    dict(
        type='OccDefaultFormatBundle3D',
        class_names=[
            'empty', 'barrier', 'bicycle', 'bus', 'car',
            'construction_vehicle', 'motorcycle', 'pedestrian', 'traffic_cone',
            'trailer', 'truck', 'driveable_surface', 'other_flat', 'sidewalk',
            'terrain', 'manmade', 'vegetation'
        ]),
    dict(
        type='Collect3D',
        keys=['img_inputs', 'gt_occ', 'points', 'points_occ'],
        meta_keys=['pc_range', 'occ_size'])
]
test_pipeline = [
    dict(type='LoadPointsFromFile', coord_type='LIDAR', load_dim=5, use_dim=5),
    dict(type='LoadPointsFromMultiSweeps', sweeps_num=10),
    dict(
        type='LoadMultiViewImageFromFiles_OccFormer',
        is_train=False,
        data_config=dict(
            cams=[
                'CAM_FRONT_LEFT', 'CAM_FRONT', 'CAM_FRONT_RIGHT',
                'CAM_BACK_LEFT', 'CAM_BACK', 'CAM_BACK_RIGHT'
            ],
            Ncams=6,
            input_size=(896, 1600),
            src_size=(900, 1600),
            resize=(0, 0),
            rot=(0, 0),
            flip=False,
            crop_h=(0.0, 0.0),
            resize_test=0.0),
        img_norm_cfg=dict(
            mean=[123.675, 116.28, 103.53],
            std=[58.395, 57.12, 57.375],
            to_rgb=True)),
    dict(
        type='LoadOccupancy',
        is_train=False,
        to_float32=True,
        use_semantic=True,
        occ_path='./data/nuscenes_occ',
        grid_size=[200, 200, 16],
        use_vel=False,
        unoccupied=0,
        pc_range=[-50, -50, -5.0, 50, 50, 3.0],
        cal_visible=False,
        bda_aug_conf=dict(
            rot_lim=(0, 0),
            scale_lim=(1, 1),
            flip_dx_ratio=0,
            flip_dy_ratio=0,
            flip_dz_ratio=0),
        cls_metas='projects/configs/_base_/nuscenes.yaml'),
    dict(
        type='OccDefaultFormatBundle3D',
        class_names=[
            'empty', 'barrier', 'bicycle', 'bus', 'car',
            'construction_vehicle', 'motorcycle', 'pedestrian', 'traffic_cone',
            'trailer', 'truck', 'driveable_surface', 'other_flat', 'sidewalk',
            'terrain', 'manmade', 'vegetation'
        ],
        with_label=False),
    dict(
        type='Collect3D',
        keys=['img_inputs', 'gt_occ', 'points', 'points_occ'],
        meta_keys=[
            'pc_range', 'occ_size', 'sample_idx', 'timestamp', 'scene_token',
            'img_filenames', 'scene_name'
        ])
]
eval_pipeline = [
    dict(
        type='LoadPointsFromFile',
        coord_type='LIDAR',
        load_dim=5,
        use_dim=5,
        file_client_args=dict(backend='disk')),
    dict(
        type='LoadPointsFromMultiSweeps',
        sweeps_num=10,
        file_client_args=dict(backend='disk')),
    dict(
        type='DefaultFormatBundle3D',
        class_names=[
            'car', 'truck', 'trailer', 'bus', 'construction_vehicle',
            'bicycle', 'motorcycle', 'pedestrian', 'traffic_cone', 'barrier'
        ],
        with_label=False),
    dict(type='Collect3D', keys=['points'])
]
data = dict(
    samples_per_gpu=1,
    workers_per_gpu=4,
    train=dict(
        type='CustomNuScenesOccLSSDataset',
        data_root='data/nuscenes',
        ann_file='data/nuscenes_infos_temporal_train.pkl',
        pipeline=[
            dict(
                type='LoadPointsFromFile',
                coord_type='LIDAR',
                load_dim=5,
                use_dim=5),
            dict(type='LoadPointsFromMultiSweeps', sweeps_num=10),
            dict(
                type='LoadMultiViewImageFromFiles_OccFormer',
                is_train=True,
                data_config=dict(
                    cams=[
                        'CAM_FRONT_LEFT', 'CAM_FRONT', 'CAM_FRONT_RIGHT',
                        'CAM_BACK_LEFT', 'CAM_BACK', 'CAM_BACK_RIGHT'
                    ],
                    Ncams=6,
                    input_size=(896, 1600),
                    src_size=(900, 1600),
                    resize=(0, 0),
                    rot=(0, 0),
                    flip=False,
                    crop_h=(0.0, 0.0),
                    resize_test=0.0),
                img_norm_cfg=dict(
                    mean=[123.675, 116.28, 103.53],
                    std=[58.395, 57.12, 57.375],
                    to_rgb=True)),
            dict(type='CreateDepthFromLiDAR', dataset='nusc'),
            dict(
                type='LoadOccupancy',
                is_train=True,
                to_float32=True,
                use_semantic=True,
                occ_path='./data/nuscenes_occ',
                grid_size=[200, 200, 16],
                use_vel=False,
                unoccupied=0,
                pc_range=[-50, -50, -5.0, 50, 50, 3.0],
                cal_visible=False,
                bda_aug_conf=dict(
                    rot_lim=(0, 0),
                    scale_lim=(1, 1),
                    flip_dx_ratio=0,
                    flip_dy_ratio=0,
                    flip_dz_ratio=0),
                cls_metas='projects/configs/_base_/nuscenes.yaml'),
            dict(
                type='OccDefaultFormatBundle3D',
                class_names=[
                    'empty', 'barrier', 'bicycle', 'bus', 'car',
                    'construction_vehicle', 'motorcycle', 'pedestrian',
                    'traffic_cone', 'trailer', 'truck', 'driveable_surface',
                    'other_flat', 'sidewalk', 'terrain', 'manmade',
                    'vegetation'
                ]),
            dict(
                type='Collect3D',
                keys=['img_inputs', 'gt_occ', 'points', 'points_occ'],
                meta_keys=['pc_range', 'occ_size'])
        ],
        classes=[
            'empty', 'barrier', 'bicycle', 'bus', 'car',
            'construction_vehicle', 'motorcycle', 'pedestrian', 'traffic_cone',
            'trailer', 'truck', 'driveable_surface', 'other_flat', 'sidewalk',
            'terrain', 'manmade', 'vegetation'
        ],
        modality=dict(
            use_lidar=True,
            use_camera=True,
            use_radar=False,
            use_map=False,
            use_external=False),
        test_mode=False,
        box_type_3d='LiDAR',
        occ_size=[200, 200, 16],
        pc_range=[-50, -50, -5.0, 50, 50, 3.0]),
    val=dict(
        type='CustomNuScenesOccLSSDataset',
        ann_file='data/nuscenes_infos_temporal_val.pkl',
        pipeline=[
            dict(
                type='LoadPointsFromFile',
                coord_type='LIDAR',
                load_dim=5,
                use_dim=5),
            dict(type='LoadPointsFromMultiSweeps', sweeps_num=10),
            dict(
                type='LoadMultiViewImageFromFiles_OccFormer',
                is_train=False,
                data_config=dict(
                    cams=[
                        'CAM_FRONT_LEFT', 'CAM_FRONT', 'CAM_FRONT_RIGHT',
                        'CAM_BACK_LEFT', 'CAM_BACK', 'CAM_BACK_RIGHT'
                    ],
                    Ncams=6,
                    input_size=(896, 1600),
                    src_size=(900, 1600),
                    resize=(0, 0),
                    rot=(0, 0),
                    flip=False,
                    crop_h=(0.0, 0.0),
                    resize_test=0.0),
                img_norm_cfg=dict(
                    mean=[123.675, 116.28, 103.53],
                    std=[58.395, 57.12, 57.375],
                    to_rgb=True)),
            dict(
                type='LoadOccupancy',
                is_train=False,
                to_float32=True,
                use_semantic=True,
                occ_path='./data/nuscenes_occ',
                grid_size=[200, 200, 16],
                use_vel=False,
                unoccupied=0,
                pc_range=[-50, -50, -5.0, 50, 50, 3.0],
                cal_visible=False,
                bda_aug_conf=dict(
                    rot_lim=(0, 0),
                    scale_lim=(1, 1),
                    flip_dx_ratio=0,
                    flip_dy_ratio=0,
                    flip_dz_ratio=0),
                cls_metas='projects/configs/_base_/nuscenes.yaml'),
            dict(
                type='OccDefaultFormatBundle3D',
                class_names=[
                    'empty', 'barrier', 'bicycle', 'bus', 'car',
                    'construction_vehicle', 'motorcycle', 'pedestrian',
                    'traffic_cone', 'trailer', 'truck', 'driveable_surface',
                    'other_flat', 'sidewalk', 'terrain', 'manmade',
                    'vegetation'
                ],
                with_label=False),
            dict(
                type='Collect3D',
                keys=['img_inputs', 'gt_occ', 'points', 'points_occ'],
                meta_keys=[
                    'pc_range', 'occ_size', 'sample_idx', 'timestamp',
                    'scene_token', 'img_filenames', 'scene_name'
                ])
        ],
        classes=[
            'empty', 'barrier', 'bicycle', 'bus', 'car',
            'construction_vehicle', 'motorcycle', 'pedestrian', 'traffic_cone',
            'trailer', 'truck', 'driveable_surface', 'other_flat', 'sidewalk',
            'terrain', 'manmade', 'vegetation'
        ],
        modality=dict(
            use_lidar=True,
            use_camera=True,
            use_radar=False,
            use_map=False,
            use_external=False),
        test_mode=True,
        box_type_3d='LiDAR',
        data_root='data/nuscenes',
        occ_size=[200, 200, 16],
        pc_range=[-50, -50, -5.0, 50, 50, 3.0]),
    test=dict(
        type='CustomNuScenesOccLSSDataset',
        data_root='data/nuscenes',
        ann_file='data/nuscenes_infos_temporal_val.pkl',
        pipeline=[
            dict(
                type='LoadPointsFromFile',
                coord_type='LIDAR',
                load_dim=5,
                use_dim=5),
            dict(type='LoadPointsFromMultiSweeps', sweeps_num=10),
            dict(
                type='LoadMultiViewImageFromFiles_OccFormer',
                is_train=False,
                data_config=dict(
                    cams=[
                        'CAM_FRONT_LEFT', 'CAM_FRONT', 'CAM_FRONT_RIGHT',
                        'CAM_BACK_LEFT', 'CAM_BACK', 'CAM_BACK_RIGHT'
                    ],
                    Ncams=6,
                    input_size=(896, 1600),
                    src_size=(900, 1600),
                    resize=(0, 0),
                    rot=(0, 0),
                    flip=False,
                    crop_h=(0.0, 0.0),
                    resize_test=0.0),
                img_norm_cfg=dict(
                    mean=[123.675, 116.28, 103.53],
                    std=[58.395, 57.12, 57.375],
                    to_rgb=True)),
            dict(
                type='LoadOccupancy',
                is_train=False,
                to_float32=True,
                use_semantic=True,
                occ_path='./data/nuscenes_occ',
                grid_size=[200, 200, 16],
                use_vel=False,
                unoccupied=0,
                pc_range=[-50, -50, -5.0, 50, 50, 3.0],
                cal_visible=False,
                bda_aug_conf=dict(
                    rot_lim=(0, 0),
                    scale_lim=(1, 1),
                    flip_dx_ratio=0,
                    flip_dy_ratio=0,
                    flip_dz_ratio=0),
                cls_metas='projects/configs/_base_/nuscenes.yaml'),
            dict(
                type='OccDefaultFormatBundle3D',
                class_names=[
                    'empty', 'barrier', 'bicycle', 'bus', 'car',
                    'construction_vehicle', 'motorcycle', 'pedestrian',
                    'traffic_cone', 'trailer', 'truck', 'driveable_surface',
                    'other_flat', 'sidewalk', 'terrain', 'manmade',
                    'vegetation'
                ],
                with_label=False),
            dict(
                type='Collect3D',
                keys=['img_inputs', 'gt_occ', 'points', 'points_occ'],
                meta_keys=[
                    'pc_range', 'occ_size', 'sample_idx', 'timestamp',
                    'scene_token', 'img_filenames', 'scene_name'
                ])
        ],
        classes=[
            'empty', 'barrier', 'bicycle', 'bus', 'car',
            'construction_vehicle', 'motorcycle', 'pedestrian', 'traffic_cone',
            'trailer', 'truck', 'driveable_surface', 'other_flat', 'sidewalk',
            'terrain', 'manmade', 'vegetation'
        ],
        modality=dict(
            use_lidar=True,
            use_camera=True,
            use_radar=False,
            use_map=False,
            use_external=False),
        test_mode=True,
        box_type_3d='LiDAR',
        occ_size=[200, 200, 16],
        pc_range=[-50, -50, -5.0, 50, 50, 3.0]),
    shuffler_sampler=dict(type='DistributedGroupSampler'),
    nonshuffler_sampler=dict(type='DistributedSampler'))
evaluation = dict(
    interval=1,
    pipeline=[
        dict(
            type='LoadPointsFromFile',
            coord_type='LIDAR',
            load_dim=5,
            use_dim=5),
        dict(type='LoadPointsFromMultiSweeps', sweeps_num=10),
        dict(
            type='LoadMultiViewImageFromFiles_OccFormer',
            is_train=False,
            data_config=dict(
                cams=[
                    'CAM_FRONT_LEFT', 'CAM_FRONT', 'CAM_FRONT_RIGHT',
                    'CAM_BACK_LEFT', 'CAM_BACK', 'CAM_BACK_RIGHT'
                ],
                Ncams=6,
                input_size=(896, 1600),
                src_size=(900, 1600),
                resize=(0, 0),
                rot=(0, 0),
                flip=False,
                crop_h=(0.0, 0.0),
                resize_test=0.0),
            img_norm_cfg=dict(
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True)),
        dict(
            type='LoadOccupancy',
            is_train=False,
            to_float32=True,
            use_semantic=True,
            occ_path='./data/nuscenes_occ',
            grid_size=[200, 200, 16],
            use_vel=False,
            unoccupied=0,
            pc_range=[-50, -50, -5.0, 50, 50, 3.0],
            cal_visible=False,
            bda_aug_conf=dict(
                rot_lim=(0, 0),
                scale_lim=(1, 1),
                flip_dx_ratio=0,
                flip_dy_ratio=0,
                flip_dz_ratio=0),
            cls_metas='projects/configs/_base_/nuscenes.yaml'),
        dict(
            type='OccDefaultFormatBundle3D',
            class_names=[
                'empty', 'barrier', 'bicycle', 'bus', 'car',
                'construction_vehicle', 'motorcycle', 'pedestrian',
                'traffic_cone', 'trailer', 'truck', 'driveable_surface',
                'other_flat', 'sidewalk', 'terrain', 'manmade', 'vegetation'
            ],
            with_label=False),
        dict(
            type='Collect3D',
            keys=['img_inputs', 'gt_occ', 'points', 'points_occ'],
            meta_keys=[
                'pc_range', 'occ_size', 'sample_idx', 'timestamp',
                'scene_token', 'img_filenames', 'scene_name'
            ])
    ],
    save_best='SSC_mean',
    rule='greater')
checkpoint_config = dict(interval=1, max_keep_ckpts=1)
log_config = dict(
    interval=50,
    hooks=[dict(type='TextLoggerHook'),
           dict(type='TensorboardLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
work_dir = './work_dirs/bifuser'
load_from = None
resume_from = None
workflow = [('train', 1)]
sync_bn = True
plugin = True
plugin_dir = 'projects/mmdet3d_plugin/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
occ_path = './data/nuscenes_occ'
num_class = 17
occ_size = [200, 200, 16]
lss_downsample = [2, 2, 2]
voxel_x = 0.5
voxel_y = 0.5
voxel_z = 0.5
voxel_size = [0.5, 0.5, 0.5]
data_config = dict(
    cams=[
        'CAM_FRONT_LEFT', 'CAM_FRONT', 'CAM_FRONT_RIGHT', 'CAM_BACK_LEFT',
        'CAM_BACK', 'CAM_BACK_RIGHT'
    ],
    Ncams=6,
    input_size=(896, 1600),
    src_size=(900, 1600),
    resize=(0, 0),
    rot=(0, 0),
    flip=False,
    crop_h=(0.0, 0.0),
    resize_test=0.0)
scale = 16
grid_config = dict(
    xbound=[-50, 50, 1.0],
    ybound=[-50, 50, 1.0],
    zbound=[-5.0, 3.0, 1.0],
    dbound=[2.0, 58.0, 0.5])
numC_Trans = 128
voxel_channels = [128, 256, 512, 1024]
voxel_channels_half = [64, 128, 256, 512]
voxel_num_layer = [2, 2, 2, 2]
voxel_strides = [1, 2, 2, 2]
voxel_out_indices = (0, 1, 2, 3)
voxel_out_channel = 256
voxel_out_channel_half = 128
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
empty_idx = 0
num_cls = 17
visible_mask = False
cascade_ratio = 2
sample_from_voxel = True
sample_from_img = True
model = dict(
    type='NeRFOcc',
    loss_norm=True,
    voxel_size=[0.5, 0.5, 0.5],
    n_voxels=[200, 200, 16],
    aabb=([-51.2, -51.2, -5.0], [51.2, 51.2, 3.0]),
    near_far_range=[0.2, 50],
    N_samples=64,
    N_rand=2048,
    depth_supervise=True,
    use_nerf_mask=True,
    nerf_sample_view=6,
    squeeze_scale=4,
    scale=16,
    nerf_density=True,
    use_rendering=True,
    test_rendering=False,
    loss_voxel_ce_weight=1.0,
    loss_voxel_sem_scal_weight=1.0,
    loss_voxel_geo_scal_weight=1.0,
    loss_voxel_lovasz_weight=1.0,
    img_backbone=dict(
        pretrained='ckpts/resnet50-0676ba61.pth',
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=0,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=False,
        style='pytorch'),
    img_neck=dict(
        type='SECONDFPN',
        in_channels=[256, 512, 1024, 2048],
        upsample_strides=[0.25, 0.5, 1, 2],
        out_channels=[128, 128, 128, 128]),
    img_view_transformer=dict(
        type='ViewTransformerLiftSplatShootVoxel',
        scale=16,
        loss_depth_weight=1.0,
        loss_depth_type='bce',
        grid_config=dict(
            xbound=[-50, 50, 1.0],
            ybound=[-50, 50, 1.0],
            zbound=[-5.0, 3.0, 1.0],
            dbound=[2.0, 58.0, 0.5]),
        data_config=dict(
            cams=[
                'CAM_FRONT_LEFT', 'CAM_FRONT', 'CAM_FRONT_RIGHT',
                'CAM_BACK_LEFT', 'CAM_BACK', 'CAM_BACK_RIGHT'
            ],
            Ncams=6,
            input_size=(896, 1600),
            src_size=(900, 1600),
            resize=(0, 0),
            rot=(0, 0),
            flip=False,
            crop_h=(0.0, 0.0),
            resize_test=0.0),
        numC_Trans=128,
        vp_megvii=False),
    pts_voxel_layer=dict(
        max_num_points=10,
        point_cloud_range=[-50, -50, -5.0, 50, 50, 3.0],
        voxel_size=[0.1, 0.1, 0.1],
        max_voxels=(90000, 120000)),
    pts_voxel_encoder=dict(type='HardSimpleVFE', num_features=5),
    pts_middle_encoder=dict(
        type='SparseLiDAREnc8x',
        input_channel=4,
        base_channel=16,
        out_channel=128,
        norm_cfg=dict(type='SyncBN', requires_grad=True),
        sparse_shape_xyz=[800, 800, 64]),
    occ_fuser=dict(
        type='BiFuser_N', knum=2, in_channels=128, out_channels=128),
    density_encoder=dict(
        type='FPN3D_Render',
        with_cp=True,
        in_channels=[128, 256, 512, 1024],
        out_channels=256,
        norm_cfg=dict(type='SyncBN', requires_grad=True)),
    color_encoder=dict(
        type='FPN3D_Render',
        with_cp=True,
        in_channels=[128, 256, 512, 1024],
        out_channels=256,
        norm_cfg=dict(type='SyncBN', requires_grad=True)),
    semantic_encoder=dict(
        type='CustomResNet3D',
        depth=18,
        n_input_channels=128,
        block_inplanes=[128, 256, 512, 1024],
        out_indices=(0, 1, 2, 3),
        norm_cfg=dict(type='SyncBN', requires_grad=True)),
    semantic_neck=dict(
        type='FPN3D',
        with_cp=True,
        in_channels=[128, 256, 512, 1024],
        out_channels=256,
        norm_cfg=dict(type='SyncBN', requires_grad=True)),
    pts_bbox_head=dict(
        type='OccHead',
        norm_cfg=dict(type='SyncBN', requires_grad=True),
        soft_weights=True,
        cascade_ratio=2,
        sample_from_voxel=True,
        sample_from_img=True,
        final_occ_size=[200, 200, 16],
        fine_topk=15000,
        empty_idx=0,
        num_level=4,
        in_channels=[256, 256, 256, 256],
        out_channel=17,
        point_cloud_range=[-50, -50, -5.0, 50, 50, 3.0],
        loss_weight_cfg=dict(
            loss_voxel_ce_weight=1.0,
            loss_voxel_sem_scal_weight=1.0,
            loss_voxel_geo_scal_weight=1.0,
            loss_voxel_lovasz_weight=1.0)),
    empty_idx=0)
nusc_class_metas = 'projects/configs/_base_/nuscenes.yaml'
bda_aug_conf = dict(
    rot_lim=(0, 0),
    scale_lim=(1, 1),
    flip_dx_ratio=0,
    flip_dy_ratio=0,
    flip_dz_ratio=0)
test_config = dict(
    type='CustomNuScenesOccLSSDataset',
    data_root='data/nuscenes',
    ann_file='data/nuscenes_infos_temporal_val.pkl',
    pipeline=[
        dict(
            type='LoadPointsFromFile',
            coord_type='LIDAR',
            load_dim=5,
            use_dim=5),
        dict(type='LoadPointsFromMultiSweeps', sweeps_num=10),
        dict(
            type='LoadMultiViewImageFromFiles_OccFormer',
            is_train=False,
            data_config=dict(
                cams=[
                    'CAM_FRONT_LEFT', 'CAM_FRONT', 'CAM_FRONT_RIGHT',
                    'CAM_BACK_LEFT', 'CAM_BACK', 'CAM_BACK_RIGHT'
                ],
                Ncams=6,
                input_size=(896, 1600),
                src_size=(900, 1600),
                resize=(0, 0),
                rot=(0, 0),
                flip=False,
                crop_h=(0.0, 0.0),
                resize_test=0.0),
            img_norm_cfg=dict(
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True)),
        dict(
            type='LoadOccupancy',
            is_train=False,
            to_float32=True,
            use_semantic=True,
            occ_path='./data/nuscenes_occ',
            grid_size=[200, 200, 16],
            use_vel=False,
            unoccupied=0,
            pc_range=[-50, -50, -5.0, 50, 50, 3.0],
            cal_visible=False,
            bda_aug_conf=dict(
                rot_lim=(0, 0),
                scale_lim=(1, 1),
                flip_dx_ratio=0,
                flip_dy_ratio=0,
                flip_dz_ratio=0),
            cls_metas='projects/configs/_base_/nuscenes.yaml'),
        dict(
            type='OccDefaultFormatBundle3D',
            class_names=[
                'empty', 'barrier', 'bicycle', 'bus', 'car',
                'construction_vehicle', 'motorcycle', 'pedestrian',
                'traffic_cone', 'trailer', 'truck', 'driveable_surface',
                'other_flat', 'sidewalk', 'terrain', 'manmade', 'vegetation'
            ],
            with_label=False),
        dict(
            type='Collect3D',
            keys=['img_inputs', 'gt_occ', 'points', 'points_occ'],
            meta_keys=[
                'pc_range', 'occ_size', 'sample_idx', 'timestamp',
                'scene_token', 'img_filenames', 'scene_name'
            ])
    ],
    classes=[
        'empty', 'barrier', 'bicycle', 'bus', 'car', 'construction_vehicle',
        'motorcycle', 'pedestrian', 'traffic_cone', 'trailer', 'truck',
        'driveable_surface', 'other_flat', 'sidewalk', 'terrain', 'manmade',
        'vegetation'
    ],
    modality=dict(
        use_lidar=True,
        use_camera=True,
        use_radar=False,
        use_map=False,
        use_external=False),
    occ_size=[200, 200, 16],
    pc_range=[-50, -50, -5.0, 50, 50, 3.0])
embed_multi = dict(lr_mult=1.0, decay_mult=0.0)
optimizer = dict(
    type='AdamW',
    lr=0.0001,
    weight_decay=0.01,
    eps=1e-08,
    betas=(0.9, 0.999),
    paramwise_cfg=dict(
        custom_keys=dict(
            query_embed=dict(lr_mult=1.0, decay_mult=0.0),
            query_feat=dict(lr_mult=1.0, decay_mult=0.0),
            level_embed=dict(lr_mult=1.0, decay_mult=0.0),
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0)),
        norm_decay_mult=0.0))
optimizer_config = dict(grad_clip=dict(max_norm=5, norm_type=2))
lr_config = dict(policy='step', step=[20, 23])
runner = dict(type='EpochBasedRunner', max_epochs=24)
gpu_ids = range(0, 8)

2023-10-25 09:10:48,612 - mmdet - INFO - Set random seed to 0, deterministic: False
/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet/models/backbones/resnet.py:400: UserWarning: DeprecationWarning: pretrained is deprecated, please use "init_cfg" instead
  warnings.warn('DeprecationWarning: pretrained is deprecated, '
/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet/models/backbones/resnet.py:400: UserWarning: DeprecationWarning: pretrained is deprecated, please use "init_cfg" instead
  warnings.warn('DeprecationWarning: pretrained is deprecated, '
/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet/models/backbones/resnet.py:400: UserWarning: DeprecationWarning: pretrained is deprecated, please use "init_cfg" instead
  warnings.warn('DeprecationWarning: pretrained is deprecated, '
/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet/models/backbones/resnet.py:400: UserWarning: DeprecationWarning: pretrained is deprecated, please use "init_cfg" instead
  warnings.warn('DeprecationWarning: pretrained is deprecated, '
/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet/models/backbones/resnet.py:400: UserWarning: DeprecationWarning: pretrained is deprecated, please use "init_cfg" instead
  warnings.warn('DeprecationWarning: pretrained is deprecated, '
/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet/models/backbones/resnet.py:400: UserWarning: DeprecationWarning: pretrained is deprecated, please use "init_cfg" instead
  warnings.warn('DeprecationWarning: pretrained is deprecated, '
/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet/models/backbones/resnet.py:400: UserWarning: DeprecationWarning: pretrained is deprecated, please use "init_cfg" instead
  warnings.warn('DeprecationWarning: pretrained is deprecated, '
/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet/models/backbones/resnet.py:400: UserWarning: DeprecationWarning: pretrained is deprecated, please use "init_cfg" instead
  warnings.warn('DeprecationWarning: pretrained is deprecated, '
Traceback (most recent call last):
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 52, in build_from_cfg
    return obj_cls(**args)
  File "/hpc2hdd/home/jpan305/pytorch/MoEOccupancy/projects/mmdet3d_plugin/occformer/detectors/nerfocc.py", line 80, in __init__
Traceback (most recent call last):
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 52, in build_from_cfg
    return obj_cls(**args)
  File "/hpc2hdd/home/jpan305/pytorch/MoEOccupancy/projects/mmdet3d_plugin/occformer/detectors/nerfocc.py", line 80, in __init__
        self.occ_fuser = builder.build_fusion_layer(occ_fuser) if occ_fuser is not None else Noneself.occ_fuser = builder.build_fusion_layer(occ_fuser) if occ_fuser is not None else None

  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 99, in build_fusion_layer
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 99, in build_fusion_layer
        return FUSION_LAYERS.build(cfg)return FUSION_LAYERS.build(cfg)

  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 212, in build
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 212, in build
        return self.build_func(*args, **kwargs, registry=self)return self.build_func(*args, **kwargs, registry=self)

  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/cnn/builder.py", line 27, in build_model_from_cfg
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/cnn/builder.py", line 27, in build_model_from_cfg
        return build_from_cfg(cfg, registry, default_args)return build_from_cfg(cfg, registry, default_args)

  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 45, in build_from_cfg
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 45, in build_from_cfg
    f'{obj_type} is not in the {registry.name} registry')    
f'{obj_type} is not in the {registry.name} registry')
KeyErrorKeyError: : 'BiFuser_N is not in the models registry''BiFuser_N is not in the models registry'


During handling of the above exception, another exception occurred:


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
Traceback (most recent call last):
  File "tools/train.py", line 263, in <module>
  File "tools/train.py", line 263, in <module>
Traceback (most recent call last):
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 52, in build_from_cfg
    return obj_cls(**args)
  File "/hpc2hdd/home/jpan305/pytorch/MoEOccupancy/projects/mmdet3d_plugin/occformer/detectors/nerfocc.py", line 80, in __init__
    self.occ_fuser = builder.build_fusion_layer(occ_fuser) if occ_fuser is not None else None
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 99, in build_fusion_layer
    main()    
    main()  File "tools/train.py", line 218, in main
return FUSION_LAYERS.build(cfg)

  File "tools/train.py", line 218, in main
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 212, in build
    test_cfg=cfg.get('test_cfg'))
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 84, in build_model
        return self.build_func(*args, **kwargs, registry=self)test_cfg=cfg.get('test_cfg'))

  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/cnn/builder.py", line 27, in build_model_from_cfg
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 84, in build_model
    return build_detector(cfg, train_cfg=train_cfg, test_cfg=test_cfg)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 58, in build_detector
    return build_from_cfg(cfg, registry, default_args)
      File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 45, in build_from_cfg
return build_detector(cfg, train_cfg=train_cfg, test_cfg=test_cfg)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 58, in build_detector
    cfg, default_args=dict(train_cfg=train_cfg, test_cfg=test_cfg))
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 212, in build
    f'{obj_type} is not in the {registry.name} registry')
    KeyErrorcfg, default_args=dict(train_cfg=train_cfg, test_cfg=test_cfg)): 
'BiFuser_N is not in the models registry'  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 212, in build


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
      File "tools/train.py", line 263, in <module>
return self.build_func(*args, **kwargs, registry=self)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/cnn/builder.py", line 27, in build_model_from_cfg
    return self.build_func(*args, **kwargs, registry=self)    
return build_from_cfg(cfg, registry, default_args)  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/cnn/builder.py", line 27, in build_model_from_cfg

  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 55, in build_from_cfg
    main()
  File "tools/train.py", line 218, in main
    return build_from_cfg(cfg, registry, default_args)
      File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 55, in build_from_cfg
raise type(e)(f'{obj_cls.__name__}: {e}')
KeyError: "NeRFOcc: 'BiFuser_N is not in the models registry'"
    test_cfg=cfg.get('test_cfg'))    
raise type(e)(f'{obj_cls.__name__}: {e}')  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 84, in build_model

KeyError: "NeRFOcc: 'BiFuser_N is not in the models registry'"
    return build_detector(cfg, train_cfg=train_cfg, test_cfg=test_cfg)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 58, in build_detector
    cfg, default_args=dict(train_cfg=train_cfg, test_cfg=test_cfg))
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 212, in build
    return self.build_func(*args, **kwargs, registry=self)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/cnn/builder.py", line 27, in build_model_from_cfg
    return build_from_cfg(cfg, registry, default_args)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 55, in build_from_cfg
    raise type(e)(f'{obj_cls.__name__}: {e}')
KeyError: "NeRFOcc: 'BiFuser_N is not in the models registry'"
Traceback (most recent call last):
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 52, in build_from_cfg
    return obj_cls(**args)
  File "/hpc2hdd/home/jpan305/pytorch/MoEOccupancy/projects/mmdet3d_plugin/occformer/detectors/nerfocc.py", line 80, in __init__
    self.occ_fuser = builder.build_fusion_layer(occ_fuser) if occ_fuser is not None else None
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 99, in build_fusion_layer
    return FUSION_LAYERS.build(cfg)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 212, in build
    return self.build_func(*args, **kwargs, registry=self)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/cnn/builder.py", line 27, in build_model_from_cfg
    return build_from_cfg(cfg, registry, default_args)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 45, in build_from_cfg
    f'{obj_type} is not in the {registry.name} registry')
KeyError: 'BiFuser_N is not in the models registry'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "tools/train.py", line 263, in <module>
    main()
  File "tools/train.py", line 218, in main
    test_cfg=cfg.get('test_cfg'))
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 84, in build_model
    return build_detector(cfg, train_cfg=train_cfg, test_cfg=test_cfg)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 58, in build_detector
    cfg, default_args=dict(train_cfg=train_cfg, test_cfg=test_cfg))
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 212, in build
    return self.build_func(*args, **kwargs, registry=self)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/cnn/builder.py", line 27, in build_model_from_cfg
    return build_from_cfg(cfg, registry, default_args)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 55, in build_from_cfg
    raise type(e)(f'{obj_cls.__name__}: {e}')
KeyError: "NeRFOcc: 'BiFuser_N is not in the models registry'"
Traceback (most recent call last):
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 52, in build_from_cfg
    return obj_cls(**args)
  File "/hpc2hdd/home/jpan305/pytorch/MoEOccupancy/projects/mmdet3d_plugin/occformer/detectors/nerfocc.py", line 80, in __init__
    self.occ_fuser = builder.build_fusion_layer(occ_fuser) if occ_fuser is not None else None
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 99, in build_fusion_layer
    return FUSION_LAYERS.build(cfg)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 212, in build
    return self.build_func(*args, **kwargs, registry=self)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/cnn/builder.py", line 27, in build_model_from_cfg
    return build_from_cfg(cfg, registry, default_args)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 45, in build_from_cfg
    f'{obj_type} is not in the {registry.name} registry')
KeyError: 'BiFuser_N is not in the models registry'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "tools/train.py", line 263, in <module>
    main()
  File "tools/train.py", line 218, in main
    test_cfg=cfg.get('test_cfg'))
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 84, in build_model
    return build_detector(cfg, train_cfg=train_cfg, test_cfg=test_cfg)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 58, in build_detector
    cfg, default_args=dict(train_cfg=train_cfg, test_cfg=test_cfg))
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 212, in build
    return self.build_func(*args, **kwargs, registry=self)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/cnn/builder.py", line 27, in build_model_from_cfg
    return build_from_cfg(cfg, registry, default_args)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 55, in build_from_cfg
    raise type(e)(f'{obj_cls.__name__}: {e}')
KeyError: "NeRFOcc: 'BiFuser_N is not in the models registry'"
Traceback (most recent call last):
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 52, in build_from_cfg
    return obj_cls(**args)
  File "/hpc2hdd/home/jpan305/pytorch/MoEOccupancy/projects/mmdet3d_plugin/occformer/detectors/nerfocc.py", line 80, in __init__
    self.occ_fuser = builder.build_fusion_layer(occ_fuser) if occ_fuser is not None else None
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 99, in build_fusion_layer
    return FUSION_LAYERS.build(cfg)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 212, in build
    return self.build_func(*args, **kwargs, registry=self)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/cnn/builder.py", line 27, in build_model_from_cfg
    return build_from_cfg(cfg, registry, default_args)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 45, in build_from_cfg
    f'{obj_type} is not in the {registry.name} registry')
KeyError: 'BiFuser_N is not in the models registry'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "tools/train.py", line 263, in <module>
    main()
  File "tools/train.py", line 218, in main
    test_cfg=cfg.get('test_cfg'))
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 84, in build_model
    return build_detector(cfg, train_cfg=train_cfg, test_cfg=test_cfg)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 58, in build_detector
    cfg, default_args=dict(train_cfg=train_cfg, test_cfg=test_cfg))
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 212, in build
    return self.build_func(*args, **kwargs, registry=self)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/cnn/builder.py", line 27, in build_model_from_cfg
    return build_from_cfg(cfg, registry, default_args)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 55, in build_from_cfg
    raise type(e)(f'{obj_cls.__name__}: {e}')
KeyError: "NeRFOcc: 'BiFuser_N is not in the models registry'"
Traceback (most recent call last):
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 52, in build_from_cfg
    return obj_cls(**args)
  File "/hpc2hdd/home/jpan305/pytorch/MoEOccupancy/projects/mmdet3d_plugin/occformer/detectors/nerfocc.py", line 80, in __init__
    self.occ_fuser = builder.build_fusion_layer(occ_fuser) if occ_fuser is not None else None
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 99, in build_fusion_layer
    return FUSION_LAYERS.build(cfg)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 212, in build
    return self.build_func(*args, **kwargs, registry=self)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/cnn/builder.py", line 27, in build_model_from_cfg
    return build_from_cfg(cfg, registry, default_args)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 45, in build_from_cfg
    f'{obj_type} is not in the {registry.name} registry')
KeyError: 'BiFuser_N is not in the models registry'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "tools/train.py", line 263, in <module>
    main()
  File "tools/train.py", line 218, in main
    test_cfg=cfg.get('test_cfg'))
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 84, in build_model
    return build_detector(cfg, train_cfg=train_cfg, test_cfg=test_cfg)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 58, in build_detector
    cfg, default_args=dict(train_cfg=train_cfg, test_cfg=test_cfg))
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 212, in build
    return self.build_func(*args, **kwargs, registry=self)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/cnn/builder.py", line 27, in build_model_from_cfg
    return build_from_cfg(cfg, registry, default_args)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 55, in build_from_cfg
    raise type(e)(f'{obj_cls.__name__}: {e}')
KeyError: "NeRFOcc: 'BiFuser_N is not in the models registry'"
Traceback (most recent call last):
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 52, in build_from_cfg
    return obj_cls(**args)
  File "/hpc2hdd/home/jpan305/pytorch/MoEOccupancy/projects/mmdet3d_plugin/occformer/detectors/nerfocc.py", line 80, in __init__
    self.occ_fuser = builder.build_fusion_layer(occ_fuser) if occ_fuser is not None else None
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 99, in build_fusion_layer
    return FUSION_LAYERS.build(cfg)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 212, in build
    return self.build_func(*args, **kwargs, registry=self)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/cnn/builder.py", line 27, in build_model_from_cfg
    return build_from_cfg(cfg, registry, default_args)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 45, in build_from_cfg
    f'{obj_type} is not in the {registry.name} registry')
KeyError: 'BiFuser_N is not in the models registry'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "tools/train.py", line 263, in <module>
    main()
  File "tools/train.py", line 218, in main
    test_cfg=cfg.get('test_cfg'))
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 84, in build_model
    return build_detector(cfg, train_cfg=train_cfg, test_cfg=test_cfg)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmdet3d-0.17.1-py3.7-linux-x86_64.egg/mmdet3d/models/builder.py", line 58, in build_detector
    cfg, default_args=dict(train_cfg=train_cfg, test_cfg=test_cfg))
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 212, in build
    return self.build_func(*args, **kwargs, registry=self)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/cnn/builder.py", line 27, in build_model_from_cfg
    return build_from_cfg(cfg, registry, default_args)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/mmcv/utils/registry.py", line 55, in build_from_cfg
    raise type(e)(f'{obj_cls.__name__}: {e}')
KeyError: "NeRFOcc: 'BiFuser_N is not in the models registry'"
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2022130 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 2022125) of binary: /hpc2hdd/home/jpan305/miniconda3/envs/openocc/bin/python
Traceback (most recent call last):
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/torch/distributed/launch.py", line 193, in <module>
    main()
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/torch/distributed/launch.py", line 189, in main
    launch(args)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/torch/distributed/launch.py", line 174, in launch
    run(args)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/torch/distributed/run.py", line 713, in run
    )(*cmd_args)
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/hpc2hdd/home/jpan305/miniconda3/envs/openocc/lib/python3.7/site-packages/torch/distributed/launcher/api.py", line 261, in launch_agent
    failures=result.failures,
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
tools/train.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-10-25_09:10:49
  host      : gpu3-13.hkust-gz.edu.cn
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 2022126)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-10-25_09:10:49
  host      : gpu3-13.hkust-gz.edu.cn
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 2022127)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-10-25_09:10:49
  host      : gpu3-13.hkust-gz.edu.cn
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 2022128)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[4]:
  time      : 2023-10-25_09:10:49
  host      : gpu3-13.hkust-gz.edu.cn
  rank      : 4 (local_rank: 4)
  exitcode  : 1 (pid: 2022129)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[5]:
  time      : 2023-10-25_09:10:49
  host      : gpu3-13.hkust-gz.edu.cn
  rank      : 6 (local_rank: 6)
  exitcode  : 1 (pid: 2022131)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[6]:
  time      : 2023-10-25_09:10:49
  host      : gpu3-13.hkust-gz.edu.cn
  rank      : 7 (local_rank: 7)
  exitcode  : 1 (pid: 2022132)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-10-25_09:10:49
  host      : gpu3-13.hkust-gz.edu.cn
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2022125)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
